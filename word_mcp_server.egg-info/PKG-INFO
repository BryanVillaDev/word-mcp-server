Metadata-Version: 2.4
Name: word-mcp-server
Version: 0.1.1
Summary: Add your description here
Requires-Python: >=3.12
Description-Content-Type: text/markdown
Requires-Dist: python-docx
Requires-Dist: langchain-mcp-adapters
Requires-Dist: opencv-python
Requires-Dist: numpy

# Xá»­ lÃ½ ngon lÃ nh Microsoft Office Word vá»›i Python-Docx

Happy New Year  
*BÃ i Ä‘Äƒng nÃ y Ä‘Ã£ khÃ´ng Ä‘Æ°á»£c cáº­p nháº­t trong 4 nÄƒm*

Microsoft Word (MS)- má»™t trong cÃ¡c tiá»‡n Ã­ch tá»« bá»™ Microsoft Office lÃ  má»™t trong nhá»¯ng pháº§n má»m phá»• biáº¿n trong viá»‡c táº¡o ra file document, há»— trá»£ Ä‘á»c vÃ  ghi ná»™i dung tá»« Ä‘Æ¡n giáº£n Ä‘áº¿n phá»©c táº¡p. Máº·c dÃ¹ con ngÆ°á»i cÃ³ thá»ƒ trá»±c tiáº¿p táº¡o vÃ  viáº¿t ná»™i dung lÃªn file MS, tuy nhiÃªn trong ráº¥t nhiá»u tÃ¡c vá»¥ cáº§n mÃ¡y tÃ­nh xá»­ lÃ½ vÃ  tá»± Ä‘á»™ng táº¡o ná»™i dung trÃªn cÃ¡c file MS. VÃ­ dá»¥ báº¡n Ä‘á»c ná»™i dung tá»« file pdf vÃ  muá»‘n chuyá»ƒn ná»™i dung sang file docx hoáº·c báº¡n Ä‘ang phÃ¡t triá»ƒn má»™t mÃ´ hÃ¬nh xá»­ lÃ½ ngÃ´n ngá»¯ tá»± nhiÃªn vÃ  cáº§n Ä‘á»c dá»¯ liá»‡u Ä‘áº§u vÃ o lÃ  cÃ¡c file MS thÃ¬ Python-Docx lÃ  má»™t trong nhá»¯ng thÆ° viá»‡n ráº¥t Ä‘Ã¡ng Ä‘á»ƒ báº¡n lá»±a chá»n.

HÃ´m nay mÃ¬nh xin giá»›i thiá»‡u cÃ¡c báº¡n cÃ¡ch táº¡o ra tá»± Ä‘á»™ng file MS cÅ©ng nhÆ° cÃ¡c tÃ­nh nÄƒng thÃªm, sá»­a, xÃ³a cÃ¡c ná»™i dung dÆ°á»›i sá»± há»— trá»£ cá»§a thÆ° viá»‡n Python Docx.

## 1. CÃ i Ä‘áº·t thÆ° viá»‡n
Náº¿u cÃ¡c báº¡n Ä‘ang sá»­ dá»¥ng anaconda, cÃ¡c báº¡n cÃ³ thá»ƒ dá»… dÃ ng cÃ i Ä‘áº·t báº±ng cÃ¡ch sau Ä‘Ã¢y:

```python
pip install python-docx
```

## 2. Khá»Ÿi táº¡o file
Äá»ƒ má»Ÿ má»™t file Ä‘Ã£ tá»“n táº¡i trÆ°á»›c Ä‘Ã³, báº¡n sá»­ dá»¥ng cÃ¢u lá»‡nh sau

```python
from docx import Document

document = Document('existing-document-file.docx')
```

Náº¿u file nÃ y chÆ°a tá»“n táº¡i, báº¡n sá»­ dá»¥ng cÃ¢u lá»‡nh sau:

```python
document = Document()
```

Sau khi báº¡n khá»Ÿi táº¡o file, báº¡n cÃ³ thá»ƒ chá»‰nh sá»­a ná»™i dung cá»§a file MS nhÆ° thÃªm Ä‘oáº¡n vÄƒn, thÃªm báº£ng, ... thÃ´ng qua biáº¿n document nhÆ° vÃ­ dá»¥ bÃªn trÃªn. Sau khi hoÃ n thiá»‡n báº¡n cÃ³ lÆ°u láº¡i nhá»¯ng thay Ä‘á»•i báº±ng cÃ¢u lá»‡nh sau:

```python
document.save(filename)
```

á» Ä‘Ã¢y, filename lÃ  tÃªn file mÃ  báº¡n muá»‘n lÆ°u. Táº¥t nhiÃªn Ä‘uÃ´i lÃ  .docx nhÃ©. ğŸ˜ƒ

## 3. Heading, title
ThÆ° viá»‡n python-docx há»— trá»£ ghi pháº§n title hoáº·c heading cá»§a vÄƒn báº£n theo nhiá»u level mÃ  ngÆ°á»i dÃ¹ng chá»‰ Ä‘á»‹nh.

```python
document.add_heading(content, level)
```

- Content: ná»™i dung title hoáº·c heading
- Level: báº­c cá»§a heading (0, 1, 2, ...). Sá»‘ cÃ ng nhá» font chá»¯ cÃ ng lá»›n.

### 3.1. Title
Theo máº·c Ä‘á»‹nh cá»§a python-docx, title cÃ³ level lÃ  0

```python
document.add_heading("This is a title part, level=0")
```

Ta cÃ³ káº¿t quáº£ tÆ°Æ¡ng á»©ng sáº½ lÃ :

### 3.2. Heading
Äá»‘i vá»›i cÃ¡c pháº§n heading, ta cÃ³ cÃ¡c level 1, 2, 3....

**Level 1**
```python
document.add_heading("This is a heading 1", level=1)
```

Káº¿t quáº£ tÆ°Æ¡ng á»©ng:

**Level 2**
```python
document.add_heading("This is a heading 2", level=2)
```

Káº¿t quáº£ tÆ°Æ¡ng á»©ng:

## 4. Äoáº¡n vÄƒn (paragraph)
Trong cÃ¡c loáº¡i vÄƒn báº£n thÃ´ng thÆ°á»ng, chÃºng ta cÃ³ hai cÃ¡ch biá»ƒu diá»…n ná»™i dung cá»§a má»™t trang Ä‘Ã³ lÃ :

- Layout truyá»n thá»‘ng: ná»™i dung Ä‘Æ°á»£c biá»ƒn diá»…n tá»« trÃªn xuá»‘ng dÆ°á»›i, tá»« trÃ¡i sang pháº£i 
- Layout dáº¡ng cá»™t: Ná»™i dung Ä‘Æ°á»£c tá»• chá»©c thÃ nh tá»«ng cá»™t riÃªng ráº½ vá»›i nhau 

### 4.1. Layout truyá»n thá»‘ng
Vá»›i layout kiá»ƒu truyá»n thá»‘ng, chÃºng ta ghi ná»™i dung vÃ o file MS nhÆ° sau:

```python
document.add_paragraph(content)
```

Káº¿t quáº£ tÆ°Æ¡ng á»©ng:

### 4.2. Layout dáº¡ng cá»™t
Äá»ƒ táº¡o ra Ä‘Æ°á»£c cÃ¡c vÄƒn báº£n dáº¡ng cá»™t. ChÃºng ta cáº§n dÃ¹ng Ä‘áº¿n khÃ¡i niá»‡m Section. Má»—i section cÃ³ thá»ƒ chá»©a nhiá»u cÃ¡c Ä‘oáº¡n vÄƒn. Má»—i section sáº½ tÆ°Æ¡ng Ä‘Æ°Æ¡ng vá»›i má»™t page vÃ  chÃºng ta thÃ´ng qua section Ä‘á»ƒ biá»ƒu diá»…n ná»™i dung cho má»™t page.

Táº¡o layout cá»™t cho section:

```python
from docx.enum.section import WD_SECTION_START

def set_number_of_columns(section, cols):
    """ sets number of columns through xpath. """
    WNS_COLS_NUM = "{http://schemas.openxmlformats.org/wordprocessingml/2006/main}num"
    section._sectPr.xpath("./w:cols")[0].set(WNS_COLS_NUM, str(cols))
    
section = document.add_section(WD_SECTION_START.NEW_PAGE)
# col_nb lÃ  sá»‘ lÆ°á»£ng bá»‘ cá»¥c cá»™t
set_number_of_columns(section, col_nb)
```

Sau Ä‘Ã³ chÃºng ta thá»±c hiá»‡n thÃªm Ä‘oáº¡n vÄƒn giá»‘ng nhÆ° kiá»ƒu layout truyá»n thá»‘ng. Äoáº¡n vÄƒn sáº½ Ä‘Æ°á»£c thÃªm theo thá»© tá»± cÃ¡c cá»™t, tá»« trÃ¡i sang pháº£i.

```python
p = document.add_paragraph(content)
```

NgoÃ i ra, chÃºng ta cÅ©ng cÃ³ thá»ƒ thÃªm pháº§n cÄƒn lá» (trÃ¡i, pháº£i, giá»¯a) cho Ä‘oáº¡n vÄƒn nhÆ° sau:

```python
from docx.enum.text import WD_PARAGRAPH_ALIGNMENT

# CÄƒn lá» trÃ¡i
p.alignment = WD_PARAGRAPH_ALIGNMENT.LEFT

# CÄƒn lá» pháº£i
p.alignment = WD_PARAGRAPH_ALIGNMENT.RIGHT

# CÄƒn lá» giá»¯a
p.alignment = WD_PARAGRAPH_ALIGNMENT.CENTER

# CÄƒn lá» hai bÃªn
p.alignment = WD_PARAGRAPH_ALIGNMENT.JUSTIFY
```

### 4.3. ThÃªm cÃ¢u cho Ä‘oáº¡n vÄƒn
ThÆ° viá»‡n python-docx há»— trá»£ chÃ¨n thÃªm cÃ¢u riÃªng láº» vÃ o trong Ä‘oáº¡n vÄƒn Ä‘Ã£ Ä‘Æ°á»£c khá»Ÿi táº¡o:

```python
# initialize new paragraph
p = document.add_paragraph(content)

# add sentence to initialized paragraph
sentence_element = p.add_run(str(content))
```

#### 4.3.1. Highlight background
Báº¡n cÅ©ng cÃ³ thá»ƒ highlight background cho tá»«ng cÃ¢u báº±ng cÃ¡c mÃ u yÃªu thÃ­ch nhÆ° sau:(highlight lÃ  tÃªn mÃ u)

```python
from docx.enum.text import WD_COLOR_INDEX

if highlight == 'black':
  color_element = WD_COLOR_INDEX.BLACK
elif highlight == 'blue':
  color_element = WD_COLOR_INDEX.BLUE
elif highlight == 'green':
  color_element = WD_COLOR_INDEX.BRIGHT_GREEN
elif highlight == 'dark blue':
   color_element = WD_COLOR_INDEX.DARK_BLUE
elif highlight == 'dark red':
  color_element = WD_COLOR_INDEX.DARK_RED
elif highlight == 'dark yellow':
  color_element = WD_COLOR_INDEX.DARK_YELLOW
elif highlight == 'dark green':
   color_element = WD_COLOR_INDEX.GREEN
elif highlight == 'pink':
  color_element = WD_COLOR_INDEX.PINK
elif highlight == 'red':
  color_element = WD_COLOR_INDEX.PINK
elif highlight == 'white':
  color_element = WD_COLOR_INDEX.WHITE
elif highlight == 'teal':
  color_element = WD_COLOR_INDEX.TEAL
elif highlight == 'yellow':
  color_element = WD_COLOR_INDEX.YELLOW
elif highlight == 'violet':
  color_element = WD_COLOR_INDEX.VIOLET
elif highlight == 'gray25':
  color_element = WD_COLOR_INDEX.GRAY_25
elif highlight == 'gray50':
  color_element = WD_COLOR_INDEX.GRAY_50
  
style = document.styles.add_style("document style", WD_STYLE_TYPE.CHARACTER)
style.font.highlight_color = color_element
sentence_element = p.add_run(str(c), style=self.style)
```

#### 4.3.2. In Ä‘áº­m, nghiÃªng, gáº¡ch chÃ¢n
Báº¡n cÅ©ng cÃ³ thá»ƒ thÃªm highlight cho báº±ng thÃªm in Ä‘áº­m, in nghiÃªng hay gáº¡ch chÃ¢n nhÆ° khi ngÆ°á»i sá»­ dá»¥ng trá»±c tiáº¿p trÃªn file MS.

```python
# set bold, italic, underline value which is boolean value True or False
sentence_element = p.add_run(str(content))
sentence_element.bold = bold
sentence_element.italic = italic
sentence_element.underline = underline
```

## 5. Picture
Báº¡n cÅ©ng cÃ³ thá»ƒ chÃ¨n áº£nh trÆ°c tiáº¿p vÃ o python-docx báº±ng Ä‘Æ°á»ng dáº«n tá»›i file áº£nh cáº§n chÃ¨n hoáº·c áº£nh Ä‘Ã£ Ä‘Æ°á»£c biá»ƒu diá»…n dáº¡ng ma tráº­n. Báº¡n cÅ©ng cÃ³ thá»ƒ Ä‘iá»u chá»‰nh kÃ­ch thÆ°á»›c áº£nh phÃ¹ há»£p vá»›i vÄƒn báº£n cá»§a mÃ¬nh.

```python
import cv2
from docx.shared import Inches
from io import BytesIO
import numpy as np


def add_picture(document, image_path_or_stream, width):
     """Add picture to image"""
     if isinstance(image_path_or_stream, str):
         img = cv2.imread(image_path_or_stream)
     else:
         img = np.array(image_path_or_stream)

     is_success, im_buf_arr = cv2.imencode(".jpg", img)
     byte_im = im_buf_arr.tobytes()
     stream = BytesIO(byte_im)
     document.add_picture(stream, width=Inches(width))
     
add_picture(document, 'example.jpg', 5.0)
